/*
* videojs-ga - v0.4.2 - 2017-09-14
* Copyright (c) 2017 Michael Bensoussan
* Licensed MIT
*/
(function(){var a,b=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};(a=videojs.registerPlugin||videojs.plugin)("ga",function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;return null==a&&(a={}),d={},this.options_["data-setup"]&&(n=JSON.parse(this.options_["data-setup"]),n.ga&&(d=n.ga)),e=["loadedmetadata","percentsPlayed","secondsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],j=a.eventsToTrack||d.eventsToTrack||e,q=a.percentsPlayedInterval||d.percentsPlayedInterval||10,w=a.secondsPlayedInterval||d.secondsPlayedInterval||15,D=a.trackerName||d.trackerName,h=a.eventCategory||d.eventCategory||"Video",i=a.eventLabel||d.eventLabel,a.debug=a.debug||!1,p=[],y=x=0,z=!1,v=[],t=0,s=null,m=function(){p=[],i||(i=this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),b.call(j,"loadedmetadata")>=0&&B("loadedmetadata",!0)},C=function(){var a,c,d,e,f;for(a=Math.round(this.currentTime()),c=Math.round(this.duration()),e=Math.round(a/c*100),d=f=0;99>=f;d=f+=q)e>=d&&b.call(p,d)<0&&(b.call(j,"start")>=0&&0===d&&e>0?B("start",!0):b.call(j,"percentsPlayed")>=0&&0!==e&&B("percent played",!0,d),e>0&&p.push(d));b.call(j,"seek")>=0&&(y=x,x=a,Math.abs(y-x)>1&&(z=!0,B("seek start",!1,y),B("seek end",!1,x)))},f=function(){B("end",!0)},r=function(){var a,c;z=!1,b.call(j,"play")>=0&&(c=Math.round(this.currentTime()),B("play",!0,c)),b.call(j,"secondsPlayed")>=0&&(t=(new Date).getTime(),a=function(a){A()},s=setInterval(a,1e3*w))},o=function(){var a,d;b.call(j,"pause")>=0&&(a=Math.round(this.currentTime()),d=Math.round(this.duration()),a===d||z||B("pause",!1,a)),b.call(j,"secondsPlayed")>=0&&c()},E=function(){var a;a=this.muted()===!0?0:this.volume(),B("volume change",!1,a)},u=function(){B("resize - "+this.width()+"*"+this.height(),!0)},g=function(){var a;a=Math.round(this.currentTime()),B("error",!0,a)},k=function(){var a;a=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?B("enter fullscreen",!1,a):B("exit fullscreen",!1,a)},l=function(){var a,b,c,d;for(b=0,c=0,d=v.length;d>c;c++)a=v[c],b+=a;return b},A=function(){var a,b;return a=(new Date).getTime(),b=a-t,B("seconds played",!0,Math.round((b+l())/1e3)),b},c=function(){var a;a=A(),v.push(a),clearInterval(s)},B=function(b,c,d){var e;e=D?D+".send":"send",window.ga?ga(e,"event",{eventCategory:h,eventAction:b,eventLabel:i,eventValue:d,nonInteraction:c}):window._gaq?_gaq.push(["_trackEvent",h,b,i,d,c]):a.debug&&console.log("Google Analytics not detected")},this.ready(function(){return this.on("loadedmetadata",m),this.on("timeupdate",C),b.call(j,"end")>=0&&this.on("ended",f),this.on("play",r),this.on("pause",o),b.call(j,"volumeChange")>=0&&this.on("volumechange",E),b.call(j,"resize")>=0&&this.on("resize",u),b.call(j,"error")>=0&&this.on("error",g),b.call(j,"fullscreen")>=0?this.on("fullscreenchange",k):void 0}),{sendbeacon:B}})}).call(this);